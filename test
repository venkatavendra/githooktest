pipeline {
    agent {label 'docker'}
    tools {
        maven 'MVN_3.6.1'
        jdk 'OracleJDK8'
    }
    stages {
        stage('Checkout') {
          steps {
            git credentialsId: 'github', url: 'git@github.com:locus-taxy/locus-test-suite.git'
          }
        }
        stage ('Test') {
            steps {
                sh """
                    pwd
                    cd TaxyServer-test-suite/
                    mvn integration-test -U -Dtest.userName=$TEST_USER -Dtest.password=$TEST_PASSWORD -Dapi.endpoint=$API_ENDPOINT
                    cd -
                    cd DashServer-test-suite/
                    mvn integration-test -U -Dtest.userName=$TEST_USER -Dtest.password=$TEST_PASSWORD -Dapi.endpoint=$API_ENDPOINT -Ddash.api.endpoint=$DASH_API_ENDPOINT
                    cd -
                    cd LotrServer-test-suite/
                    mvn integration-test -U -Dtest.userName=$TEST_USER -Dtest.password=$TEST_PASSWORD -Dapi.endpoint=$API_ENDPOINT -Dlotr.api.endpoint=$LOTR_API_ENDPOINT

                """
            }
        }
    }
}
